{
  "$comment_plan": "qb-rating SFDMU data plan - creates and activates rating/usage objects",
  "$comment_pass1": "Pass 1: Upsert/Insert all objects in Draft status. Objects with composite externalId use SFDMU notation (Field1;Field2) for matching. ProductUsageResourcePolicy and ProductUsageGrant use Insert/Id because they lack suitable unique external IDs.",
  "$comment_pass2": "Pass 2: Activate UnitOfMeasureClass and UsageResource (Statusâ†’Active). PUR/PUG activation is handled by the Apex script (activateRatingRecords.apex) due to complex API 260 ordering constraints.",
  "$comment_260": "API 260 notes: QB-DB;QB-TOKEN (Token PUR for Anchor product) is required before QB-DB Usage PURs can activate. CommitmentSpend optional PURs (QB-MTY-CMT;UR-CPUTIME/UR-DATASTORAGE) are excluded due to platform TokenResourceId auto-population conflict.",
  "apiVersion": "66.0",
  "excludeIdsFromCSVFiles": "false",
  "useSeparatedCSVFiles": true,
  "objectSets": [
    {
      "name": "First Pass - Insert/Upsert with Draft Status",
      "objects": [
        {
          "query": "SELECT ConversionFactor, CurrencyIsoCode, Description, Name, RoundingMethod, Scale, Sequence, Status, Type, UnitCode, UnitOfMeasureClassId FROM UnitOfMeasure ORDER BY UnitCode ASC",
          "operation": "Upsert",
          "externalId": "UnitCode",
          "excluded": false
        },
        {
          "query": "SELECT Code, BaseUnitOfMeasureId, DefaultUnitOfMeasureId, Description, Name, Status, Type FROM UnitOfMeasureClass ORDER BY Code ASC",
          "operation": "Upsert",
          "externalId": "Code",
          "excluded": false
        },
        {
          "query": "SELECT Code, Name, Status, UsageAccumulationMethod, UsageAccumulationPeriod FROM UsageResourceBillingPolicy ORDER BY Code ASC",
          "operation": "Upsert",
          "externalId": "Code",
          "excluded": false
        },
        {
          "query": "SELECT Category, Code, Description, Name, UsageDefinitionProductId, Status, TokenResourceId, UnitOfMeasureClassId, DefaultUnitOfMeasureId, UsageResourceBillingPolicyId FROM UsageResource ORDER BY Code ASC",
          "operation": "Upsert",
          "externalId": "Code",
          "excluded": false
        },
        {
          "query": "SELECT Name, ProductCode, StockKeepingUnit, UsageModelType FROM Product2 ORDER BY StockKeepingUnit ASC",
          "operation": "Update",
          "externalId": "StockKeepingUnit",
          "excluded": false
        },
        {
          "query": "SELECT Code, Name, IsRenewalAllowed, RenewalFrequency, RenewalFrequencyUnit, Status FROM UsageGrantRenewalPolicy ORDER BY Code ASC",
          "operation": "Upsert",
          "externalId": "Code",
          "excluded": false
        },
        {
          "query": "SELECT ShouldAllowRolloverExpiry, Code, MaximumRolloverCount, Name, IsRolloverAllowed, Status FROM UsageGrantRolloverPolicy ORDER BY Code ASC",
          "operation": "Upsert",
          "externalId": "Code",
          "excluded": false
        },
        {
          "query": "SELECT Name, OverageChargeable FROM UsageOveragePolicy",
          "operation": "Upsert",
          "externalId": "Name",
          "excluded": false
        },
        {
          "query": "SELECT Name FROM UsageCommitmentPolicy",
          "operation": "Upsert",
          "externalId": "Name",
          "excluded": false
        },
        {
          "query": "SELECT EffectiveEndDate, EffectiveStartDate, IsOptional, ProductId, Status, TokenResourceId, UsageResourceId FROM ProductUsageResource",
          "operation": "Upsert",
          "externalId": "Product.StockKeepingUnit;UsageResource.Code",
          "excluded": false
        },
        {
          "query": "SELECT GrantBindingTargetType, GrantBindingType, Product2Id, Name FROM UsagePrdGrantBindingPolicy ORDER BY Product2.StockKeepingUnit ASC, Name ASC",
          "operation": "Upsert",
          "externalId": "Name;Product2.StockKeepingUnit",
          "excluded": false
        },
        {
          "query": "SELECT ProductId, RatingDelayDuration, RatingPeriod, UsageResourceId FROM RatingFrequencyPolicy",
          "operation": "Upsert",
          "externalId": "RatingPeriod",
          "excluded": false
        },
        {
          "query": "SELECT ProductUsageResourceId, RatingFrequencyPolicyId, UsageAggregationPolicyId, UsageCommitmentPolicyId, UsageOveragePolicyId FROM ProductUsageResourcePolicy",
          "operation": "Insert",
          "externalId": "Id",
          "excluded": false
        },
        {
          "query": "SELECT DrawdownOrder, EffectiveStartDate, EffectiveEndDate, Label, OverageChargeable, ProductUsageResourceId, Quantity, RenewalPolicyId, RolloverPolicyId, Status, Type, UnitOfMeasureClassId, UnitOfMeasureId, UsageDefinitionProductId, ValidityPeriodTerm, ValidityPeriodUnit FROM ProductUsageGrant ORDER BY UsageDefinitionProduct.StockKeepingUnit ASC, UnitOfMeasureClass.Code ASC, UnitOfMeasure.UnitCode ASC",
          "operation": "Insert",
          "externalId": "Id",
          "excluded": false
        }
      ]
    },
    {
      "name": "Second Pass - Activate UnitOfMeasureClass and UsageResource",
      "objects": [
        {
          "query": "SELECT Code, Status FROM UnitOfMeasureClass ORDER BY Code ASC",
          "operation": "Update",
          "externalId": "Code",
          "excluded": false
        },
        {
          "query": "SELECT Code, Status FROM UsageResource ORDER BY Code ASC",
          "operation": "Update",
          "externalId": "Code",
          "excluded": false
        }
      ]
    }
  ],
  "orgs": []
}