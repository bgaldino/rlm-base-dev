<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Create_New_Quote_with_Quote_Lines</name>
        <label>Create New Quote with Quote Lines</label>
        <locationX>182</locationX>
        <locationY>2738</locationY>
        <actionName>PlaceQuoteAction</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Get_Newly_Created_Quote</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>quote</name>
            <value>
                <elementReference>newQuote</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>quoteLineItemList</name>
            <value>
                <elementReference>quoteLinesList</elementReference>
            </value>
        </inputParameters>
        <nameSegment>PlaceQuoteAction</nameSegment>
        <offset>0</offset>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>Get_Default_Billing_Info</name>
        <label>Get Default Billing Info</label>
        <locationX>182</locationX>
        <locationY>1814</locationY>
        <actionName>GetDefaultBillingInfoFlowAction</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Does_Default_Billing_Info_Exist</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>accountId</name>
            <value>
                <elementReference>Opportunity.AccountId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>billingCurrency</name>
            <value>
                <elementReference>SelectedCurrency</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>country</name>
            <value>
                <elementReference>SelectedCountry</elementReference>
            </value>
        </inputParameters>
        <nameSegment>GetDefaultBillingInfoFlowAction</nameSegment>
        <offset>0</offset>
        <outputParameters>
            <assignToReference>defaultBillingInfo</assignToReference>
            <name>output</name>
        </outputParameters>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>Get_Supported_Countries_Per_Currency</name>
        <label>Get Supported Countries Per Currency</label>
        <locationX>380</locationX>
        <locationY>566</locationY>
        <actionName>GetSupportedCountriesFlowAction</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>AssignSelectedCountryAndCurrency_NB</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>currencyList</name>
            <value>
                <elementReference>Opportunity.CurrencyIsoCode</elementReference>
            </value>
        </inputParameters>
        <nameSegment>GetSupportedCountriesFlowAction</nameSegment>
        <offset>0</offset>
        <outputParameters>
            <assignToReference>SupportedCountriesList</assignToReference>
            <name>output</name>
        </outputParameters>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>Validate_Currency_Support_For_Country</name>
        <label>Validate Currency Support For Country</label>
        <locationX>380</locationX>
        <locationY>782</locationY>
        <actionName>ValidateCurrencySupportFlowAction</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_Currency_Supported</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>billingCurrency</name>
            <value>
                <elementReference>SelectedCurrency</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>country</name>
            <value>
                <elementReference>SelectedCountry</elementReference>
            </value>
        </inputParameters>
        <nameSegment>ValidateCurrencySupportFlowAction</nameSegment>
        <offset>0</offset>
        <outputParameters>
            <assignToReference>isBillingCurrencySupported</assignToReference>
            <name>output</name>
        </outputParameters>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>61.0</apiVersion>
    <assignments>
        <name>Add_Billing_Info_on_New_Quote</name>
        <label>Add Billing Info on New Quote</label>
        <locationX>50</locationX>
        <locationY>2030</locationY>
        <assignmentItems>
            <assignToReference>newQuote.PrimaryBillingContact__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.PrimaryBillingContact__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.SecondaryBillingContact__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.SecondaryBillingContact__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.AutoRenewal__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.AutoRenewal__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.BillingFrequency__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.BillingFrequency__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.BillingLanguage__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.BillingLanguage__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.InvoiceDispatchMethod__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.InvoiceDispatchMethod__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.PaymentMethod__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.PaymentMethod__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.PaymentTerm__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.PaymentTerm__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.PreBillDays__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.PreBillDays__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.RenewalTerm__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.RenewalTerm__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.BusinessType__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.BusinessType__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.NoTaxRegistrationIDReason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.NoTaxRegistrationIDReason__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.TaxExemptionID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.TaxExemptionID__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.TaxExemptStatus__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.TaxExemptStatus__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.TaxRegistrationID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>defaultBillingInfo.TaxRegistrationID__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_oppty_lines</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_To_Quote_Lines_List</name>
        <label>Add To Quote Lines List</label>
        <locationX>270</locationX>
        <locationY>2546</locationY>
        <assignmentItems>
            <assignToReference>quoteLinesList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>newQuoteLineItem</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Iterate_through_oppty_lines</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Auto_Renewal_Value_To_No</name>
        <label>Assign Auto Renewal Value To No</label>
        <locationX>50</locationX>
        <locationY>1214</locationY>
        <assignmentItems>
            <assignToReference>AssignAutoRenewal</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Does_Quote_and_Account_Billing_Country_match</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AssignSelectedCountryAndCurrency_NB</name>
        <label>AssignSelectedCountryAndCurrency_NB</label>
        <locationX>380</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>SelectedCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.BillingCountry</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SelectedCurrency</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.CurrencyIsoCode</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Validate_Currency_Support_For_Country</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Calculate_Next_Quote_Number</name>
        <label>Calculate Next Quote Number</label>
        <locationX>380</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>totalQuotesCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Quotes_on_Oppty</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>nextQuoteNumber</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>totalQuotesCount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>nextQuoteNumber</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Supported_Countries_Per_Currency</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Create_New_Quote</name>
        <label>Create New Quote</label>
        <locationX>182</locationX>
        <locationY>1706</locationY>
        <assignmentItems>
            <assignToReference>newQuote.AutoRenewal__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AssignAutoRenewal</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.BillingCity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.BillingCity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.BillingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SelectedCountry</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.BillingName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.BillingName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.BillingPostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.BillingPostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.BillingState</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.BillingState</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.BillingStreet</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.BillingStreet</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.CurrencyIsoCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SelectedCurrency</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.ExpirationDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ServiceStartDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CalculatedQuoteName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.OpportunityId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.Pricebook2Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>DefaultPriceBookID</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.ServiceEndDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ServiceEndDateLogic</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.ServiceStartDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ServiceStartDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.ShippingCity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.ShippingCity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.ShippingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.ShippingCountry</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.ShippingName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.ShippingName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.ShippingPostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.ShippingPostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.ShippingState</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.ShippingState</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.ShippingStreet</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>quoteAddressInfo.ShippingStreet</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuote.Term__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Term</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Default_Billing_Info</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Create_New_Quote_Line_Item</name>
        <label>Create New Quote Line Item</label>
        <locationX>270</locationX>
        <locationY>2438</locationY>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Iterate_through_oppty_lines.Description</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.OpportunityLineItemId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Iterate_through_oppty_lines.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.PricebookEntryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Iterate_through_oppty_lines.PricebookEntryId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.Product2Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Iterate_through_oppty_lines.Product2Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.Quantity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Iterate_through_oppty_lines.Quantity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.ServiceDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Iterate_through_oppty_lines.ServiceDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.UnitPrice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Iterate_through_oppty_lines.UnitPrice</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.BillingFrequency</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Annual</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.StartDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ServiceStartDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.SubscriptionTerm</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Term</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.Discount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Iterate_through_oppty_lines.Discount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>newQuoteLineItem.PeriodBoundary</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Anniversary</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_To_Quote_Lines_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Default_Selected_Billing_Country_On_Quote</name>
        <label>Default Selected Billing Country On Quote</label>
        <locationX>314</locationX>
        <locationY>1514</locationY>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.ShippingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SelectedCountry</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.BillingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SelectedCountry</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_New_Quote</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Account_Address_on_Quote</name>
        <label>Populate Account Address on Quote</label>
        <locationX>50</locationX>
        <locationY>1514</locationY>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.BillingCity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.BillingCity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.BillingName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.BillingPostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.BillingPostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.BillingState</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.BillingState</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.BillingStreet</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.BillingStreet</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.ShippingCity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.ShippingCity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.ShippingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.ShippingCountry</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.ShippingName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.ShippingPostalCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.ShippingPostalCode</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.ShippingState</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.ShippingState</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.ShippingStreet</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Opportunity.Account.ShippingStreet</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>quoteAddressInfo.BillingCountry</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SelectedCountry</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_New_Quote</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Created_Quote</name>
        <label>Populate Created Quote</label>
        <locationX>182</locationX>
        <locationY>2954</locationY>
        <assignmentItems>
            <assignToReference>CreatedQuote.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Newly_Created_Quote.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CreatedQuote.QuoteNumber</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Newly_Created_Quote.QuoteNumber</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CreatedQuote.OpportunityId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Newly_Created_Quote.OpportunityId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CreatedQuote.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Newly_Created_Quote.Status</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CreatedQuote.TotalQuoteAmount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Newly_Created_Quote.TotalQuoteAmount__c</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Populate_Opportunity</name>
        <label>Populate Opportunity</label>
        <locationX>380</locationX>
        <locationY>242</locationY>
        <assignmentItems>
            <assignToReference>Opportunity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Opportunity_Details</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Quotes_on_Oppty</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Does_Default_Billing_Info_Exist</name>
        <label>Does Default Billing Info Exist</label>
        <locationX>182</locationX>
        <locationY>1922</locationY>
        <defaultConnector>
            <targetReference>Get_oppty_lines</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Does_Default_Billing_Info_Exist_Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>defaultBillingInfo</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Billing_Info_on_New_Quote</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_Quote_and_Account_Billing_Country_match</name>
        <label>Does Quote and Account Billing Country match ?</label>
        <locationX>182</locationX>
        <locationY>1406</locationY>
        <defaultConnector>
            <targetReference>Default_Selected_Billing_Country_On_Quote</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Matches</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SelectedCountry</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>Opportunity.Account.BillingCountry</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Populate_Account_Address_on_Quote</targetReference>
            </connector>
            <label>Matches</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Currency_Supported</name>
        <label>Is Currency Supported</label>
        <locationX>380</locationX>
        <locationY>890</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_Currency_Supported</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>isBillingCurrencySupported</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Default_Pricebook</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Term_Less_Than_12_Months</name>
        <label>Is Term Less Than 12 Months?</label>
        <locationX>182</locationX>
        <locationY>1106</locationY>
        <defaultConnector>
            <targetReference>Does_Quote_and_Account_Billing_Country_match</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Term</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <numberValue>12.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Opportunity.Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New Business</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Auto_Renewal_Value_To_No</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>CalculatedQuoteName</name>
        <dataType>String</dataType>
        <expression>{!Get_Opportunity_Details.Name} + &quot; &quot; + TEXT({!nextQuoteNumber})</expression>
    </formulas>
    <formulas>
        <name>ServiceEndDateLogic</name>
        <dataType>Date</dataType>
        <expression>IF(
DAY({!ServiceStartDate}) = 31,
DATE(
YEAR({!ServiceStartDate}) + FLOOR((MONTH({!ServiceStartDate}) + {!Term}-1) / 12),
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1,
IF(
MOD(MONTH({!ServiceStartDate}) + {!Term}-1, 12) +1 = 2,
IF(MOD(YEAR({!ServiceStartDate}) + FLOOR((MONTH({!ServiceStartDate}) +{!Term}) / 12), 4) = 0,
28, 27),
IF( OR (
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1 = 1,
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1 = 3,
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1 = 5,
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1 = 7,
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1 = 8,
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1 = 10,
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1 = 12),
30,
29
)
)
),
IF (
DAY({!ServiceStartDate}) = 30,
DATE(
YEAR({!ServiceStartDate}) + FLOOR((MONTH({!ServiceStartDate}) + {!Term}-1) / 12),
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1,
IF(
MOD(MONTH({!ServiceStartDate}) + {!Term}-1, 12) +1 = 2,
IF(MOD(YEAR({!ServiceStartDate}) + FLOOR((MONTH({!ServiceStartDate}) +{!Term}) / 12), 4) = 0,
28, 27),29
)
),

IF( AND (
DAY({!ServiceStartDate}) = 29,
MOD(MONTH({!ServiceStartDate}) + {!Term}-1, 12) +1 = 2
),
DATE(
YEAR({!ServiceStartDate}) + FLOOR((MONTH({!ServiceStartDate}) + {!Term}-1) / 12),
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1,
27
),

DATE(
YEAR({!ServiceStartDate}) + FLOOR((MONTH({!ServiceStartDate}) + {!Term} - 1) / 12),
MOD(MONTH({!ServiceStartDate}) + {!Term} - 1, 12) + 1,
DAY({!ServiceStartDate})
)-1
)
)
)</expression>
    </formulas>
    <interviewLabel>Lotus Quoting Agent - Create NB Quote {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Lotus Quoting Agent - Create NB Quote</label>
    <loops>
        <name>Iterate_through_oppty_lines</name>
        <label>Iterate through oppty lines</label>
        <locationX>182</locationX>
        <locationY>2330</locationY>
        <collectionReference>Get_oppty_lines</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Create_New_Quote_Line_Item</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_New_Quote_with_Quote_Lines</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Default_Pricebook</name>
        <label>Get Default Pricebook</label>
        <locationX>182</locationX>
        <locationY>998</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_Term_Less_Than_12_Months</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Standard Price Book</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Pricebook2</object>
        <queriedFields>Id</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Newly_Created_Quote</name>
        <label>Get Newly Created Quote</label>
        <locationX>182</locationX>
        <locationY>2846</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Populate_Created_Quote</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Create_New_Quote_with_Quote_Lines.quoteId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Quote</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Opportunity_Details</name>
        <label>Get Opportunity Details</label>
        <locationX>380</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Populate_Opportunity</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>OpportunityID</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_oppty_lines</name>
        <label>Get oppty lines</label>
        <locationX>182</locationX>
        <locationY>2222</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Iterate_through_oppty_lines</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Opportunity.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Quotes_on_Oppty</name>
        <label>Get Quotes on Oppty</label>
        <locationX>380</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Calculate_Next_Quote_Number</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Opportunity.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Quote</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>254</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Get_Opportunity_Details</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>AssignAutoRenewal</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>CreatedQuote</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>Quote</objectType>
    </variables>
    <variables>
        <name>defaultBillingInfo</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>BillingInformation__c</objectType>
    </variables>
    <variables>
        <name>DefaultPriceBookID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>01s7y000001b7OXAAY</stringValue>
        </value>
    </variables>
    <variables>
        <name>isBillingCurrencySupported</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>newQuote</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Quote</objectType>
    </variables>
    <variables>
        <name>newQuoteLineItem</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>QuoteLineItem</objectType>
    </variables>
    <variables>
        <name>nextQuoteNumber</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>Opportunity</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>OpportunityID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Quote_Name</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>quoteAddressInfo</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Quote</objectType>
    </variables>
    <variables>
        <name>quoteLinesList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>QuoteLineItem</objectType>
    </variables>
    <variables>
        <name>SelectedCountry</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>SelectedCurrency</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ServiceStartDate</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>SupportedCountriesList</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Term</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>totalQuotesCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>Valid_Through_Date</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
