<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <actionCalls>
        <description>Calls an action to send an email to the borrower who owes money to the financial institution and has agreed to pay the overdue amount in one partial payment.</description>
        <name>SendEmailToBorrowerOnePartialPayment</name>
        <label>Send Email to Borrower</label>
        <locationX>1100</locationX>
        <locationY>2354</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>ScreenDisplayPromiseToPayDetails</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>GetCollectionPlan.Contact.Email</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>EmailSubjectTextTemplate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>EmailBodyTextTemplate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>relatedRecordId</name>
            <value>
                <elementReference>GetCollectionPlan.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientId</name>
            <value>
                <elementReference>GetCollectionPlan.ContactId</elementReference>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <description>Calls an action to send an email to the borrower who owes money to the financial institution and has agreed to pay the overdue amount in three partial payments.</description>
        <name>SendEmailToBorrowerThreePartiaIPayments</name>
        <label>Send Email to Borrower</label>
        <locationX>572</locationX>
        <locationY>2138</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>ScreenDisplayPromiseToPayDetails</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>GetCollectionPlan.Contact.Email</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>EmailSubjectTextTemplate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Email3BodyTextTemplate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>relatedRecordId</name>
            <value>
                <elementReference>GetCollectionPlan.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientId</name>
            <value>
                <elementReference>GetCollectionPlan.ContactId</elementReference>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <description>Calls an action to send an email to the borrower who owes money to the financial institution and has agreed to pay the overdue amount in two partial payments.</description>
        <name>SendEmailToBorrowerTwoPartialPayments</name>
        <label>Send Email to Borrower</label>
        <locationX>836</locationX>
        <locationY>2246</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>ScreenDisplayPromiseToPayDetails</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>GetCollectionPlan.Contact.Email</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>EmailSubjectTextTemplate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>Email2BodyTextTemplate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>relatedRecordId</name>
            <value>
                <elementReference>GetCollectionPlan.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientId</name>
            <value>
                <elementReference>GetCollectionPlan.ContactId</elementReference>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <apiVersion>63.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <description>Sets the field values for the Payment schedule items to be created. Sets PaymentScheduleId to PaymentScheduleId from CreatePaymentSchedule, Status to Draft, and RequestedAmount and TargetPaymentProcessingDate to values provided by the flow user in the ScreenCollectPromiseToPayForm screen. Then adds PaymentScheduleItem to the PaymentScheduleItems record collection.</description>
        <name>SetPaymentScheduleItemVariablesOneOrMorePartialPayments</name>
        <label>Set Payment Schedule Item Variables</label>
        <locationX>600</locationX>
        <locationY>998</locationY>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.PaymentScheduleId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CreatePaymentSchedule</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.RequestedAmount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FirstPartialPaymentAmount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.TargetPaymentProcessingDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FirstPartialPaymentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.UsageType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>CollectionPlan</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewPaymentScheduleItems</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>PaymentScheduleItem</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>IsCustomerOptingToPayInTwoOrMorePartialPayments</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Sets the field values for the Payment schedule item to be created. Sets PaymentScheduleId to PaymentScheduleId from CreatePaymentSchedule, Status to Draft, and RequestedAmount and TargetPaymentProcessingDate to values provided by the flow user in the ScreenCollectPromiseToPayForm screen. Then adds PaymentScheduleItem to the NewPaymentScheduleItems record collection.</description>
        <name>SetPaymentScheduleItemVariablesThreeOrMorePartialPayments</name>
        <label>Set Payment Schedule Item Variables</label>
        <locationX>314</locationX>
        <locationY>1430</locationY>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.PaymentScheduleId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CreatePaymentSchedule</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.RequestedAmount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ThirdPartialPaymentAmount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.TargetPaymentProcessingDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ThirdPartialPaymentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.UsageType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>CollectionPlan</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewPaymentScheduleItems</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>PaymentScheduleItem</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>CreatePaymentScheduleItems</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Sets the field values for the Payment schedule item to be created. Sets PaymentScheduleId to PaymentScheduleId from CreatePaymentSchedule, Status to Draft, and RequestedAmount and TargetPaymentProcessingDate to values provided by the flow user in the ScreenCollectPromiseToPayForm screen. Then adds PaymentScheduleItem to the NewPaymentScheduleItems record collection.</description>
        <name>SetPaymentScheduleItemVariablesTwoOrMorePartialPayments</name>
        <label>Set Payment Schedule Item Variables</label>
        <locationX>446</locationX>
        <locationY>1214</locationY>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.PaymentScheduleId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CreatePaymentSchedule</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.RequestedAmount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SecondPartialPaymentAmount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.TargetPaymentProcessingDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SecondPartialPaymentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentScheduleItem.UsageType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>CollectionPlan</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>NewPaymentScheduleItems</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>PaymentScheduleItem</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>IsCustomerOptingToPayInThreeOrMorePartialPayments</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Sets existingPaymentSchedulesCount to the number of the payment schedule records in Payment Schedules from GetPaymentSchedules.</description>
        <name>SetPaymentSchedulesCount</name>
        <label>Set Payment Schedules Count</label>
        <locationX>560</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>existingPaymentSchedulesCount</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>GetPaymentSchedules</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>IsPromiseToPayLimitReached</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Sets totalOverdueAmount to the current due amount of the record in Collection Plan from GetCollectionPlan.</description>
        <name>SetTotalOverdueAmount</name>
        <label>Set Total Overdue Amount</label>
        <locationX>560</locationX>
        <locationY>242</locationY>
        <assignmentItems>
            <assignToReference>totalOverdueAmount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>GetCollectionPlan.null__NotFound</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MaximumPromiseToPayCount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>GetCollectionPlan.MaximumPromisetoPayCount</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>GetPaymentSchedules</targetReference>
        </connector>
    </assignments>
    <choices>
        <description>Stores the choice label and value for the ChoiceFullPayment option for PaymentPreferenceRadioButtons on the ScreenCollectPromiseToPayDetails screen.</description>
        <name>ChoiceFullPayment</name>
        <choiceText>Yes</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>choiceFullPayment</stringValue>
        </value>
    </choices>
    <choices>
        <description>Stores the choice label and value for the ChoiceOnePartialPayment option for TotalPartialPaymentsPicklist on the ScreenCollectPromiseToPayDetails screen.</description>
        <name>ChoiceOnePartialPayment</name>
        <choiceText>1</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>1.0</numberValue>
        </value>
    </choices>
    <choices>
        <description>Stores the choice label and value for the ChoicePartialPayment option for PaymentPreferenceRadioButtons on the ScreenCollectPromiseToPayDetails screen.</description>
        <name>ChoicePartialPayment</name>
        <choiceText>No</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>choicePartialPayment</stringValue>
        </value>
    </choices>
    <choices>
        <description>Stores the choice label and value for the ChoiceThreePartialPayments option for TotalPartialPaymentsPicklist on the ScreenCollectPromiseToPayDetails screen.</description>
        <name>ChoiceThreePartialPayments</name>
        <choiceText>3</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>3.0</numberValue>
        </value>
    </choices>
    <choices>
        <description>Stores the choice label and value for the ChoiceTwoPartialPayments option for TotalPartialPaymentsPicklist on the ScreenCollectPromiseToPayDetails screen.</description>
        <name>ChoiceTwoPartialPayments</name>
        <choiceText>2</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>2.0</numberValue>
        </value>
    </choices>
    <decisions>
        <description>Determines whether the collection plan has an associated email ID.</description>
        <name>HaveEmailId</name>
        <label>Have Email ID?</label>
        <locationX>600</locationX>
        <locationY>1922</locationY>
        <defaultConnector>
            <targetReference>IsCustomerPayingInThreePartialPayments</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Yes (Default)</defaultConnectorLabel>
        <rules>
            <name>HasNoEmailId</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>GetCollectionPlan.ContactId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>GetCollectionPlan.Contact.Email</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>GetCollectionPlan.Contact.Email</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>ScreenDisplayPromiseToPayDetails</targetReference>
            </connector>
            <label>No</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the customer is opting to pay in one or more partial payments by checking if the user selected a value for the TotalPartialPaymentsPicklist that&apos;s greater than or equal to one.</description>
        <name>IsCustomerOptingToPayInOneOrMorePartialPayments</name>
        <label>Is Customer Opting to Pay in One or More Partial Payments?</label>
        <locationX>1070</locationX>
        <locationY>890</locationY>
        <defaultConnectorLabel>No (Default)</defaultConnectorLabel>
        <rules>
            <name>IsOneOrMorePartialPayments</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>ChoiceOnePartialPayment</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetPaymentScheduleItemVariablesOneOrMorePartialPayments</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the customer is opting to pay in three or more partial payments by checking if the user selected a value for the TotalPartialPaymentsPicklist that&apos;s greater than or equal to three.</description>
        <name>IsCustomerOptingToPayInThreeOrMorePartialPayments</name>
        <label>Is Customer Opting to Pay in Three or More Partial Payments?</label>
        <locationX>446</locationX>
        <locationY>1322</locationY>
        <defaultConnector>
            <targetReference>CreatePaymentScheduleItems</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No (Default)</defaultConnectorLabel>
        <rules>
            <name>IsThreeOrMorePartialPayments</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>ChoiceThreePartialPayments</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetPaymentScheduleItemVariablesThreeOrMorePartialPayments</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the customer is opting to pay in two or more partial payments by checking if the user selected a value for the TotalPartialPaymentsPicklist that&apos;s greater than or equal to two.</description>
        <name>IsCustomerOptingToPayInTwoOrMorePartialPayments</name>
        <label>Is Customer Opting to Pay in Two or More Partial Payments?</label>
        <locationX>600</locationX>
        <locationY>1106</locationY>
        <defaultConnector>
            <targetReference>CreatePaymentScheduleItems</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No (Default)</defaultConnectorLabel>
        <rules>
            <name>IsTwoOrMorePartialPayments</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>ChoiceTwoPartialPayments</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SetPaymentScheduleItemVariablesTwoOrMorePartialPayments</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the customer is paying in one partial payment by checking if TotalPartialPaymentsPicklist is equal to ChoiceOnePartialPayment.</description>
        <name>IsCustomerPayingInOnePartialPayment</name>
        <label>Is Customer Paying in One Partial Payment?</label>
        <locationX>1232</locationX>
        <locationY>2246</locationY>
        <defaultConnector>
            <targetReference>ScreenDisplayPromiseToPayDetails</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No (Default)</defaultConnectorLabel>
        <rules>
            <name>IsOnePartialPayment</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>ChoiceOnePartialPayment</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SendEmailToBorrowerOnePartialPayment</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the customer is paying in the three partial payments by checking if TotalPartialPaymentsPicklist is equal to ChoiceThreePartialPayments.</description>
        <name>IsCustomerPayingInThreePartialPayments</name>
        <label>Is Customer Paying in Three Partial Payments?</label>
        <locationX>803</locationX>
        <locationY>2030</locationY>
        <defaultConnector>
            <targetReference>IsCustomerPayingInTwoPartialPayments</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No (Default)</defaultConnectorLabel>
        <rules>
            <name>IsThreePartialPayments</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>ChoiceThreePartialPayments</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SendEmailToBorrowerThreePartiaIPayments</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the customer is paying in two partial payments by checking if TotalPartialPaymentsPicklist is equal to ChoiceTwoPartialPayments.</description>
        <name>IsCustomerPayingInTwoPartialPayments</name>
        <label>Is Customer Paying in Two Partial Payments?</label>
        <locationX>1034</locationX>
        <locationY>2138</locationY>
        <defaultConnector>
            <targetReference>IsCustomerPayingInOnePartialPayment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No (Default)</defaultConnectorLabel>
        <rules>
            <name>IsTwoPartialPayments</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>ChoiceTwoPartialPayments</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SendEmailToBorrowerTwoPartialPayments</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the existing payment schedules count has reached the promise to pay limit by checking if MaximumPromiseToPayCount is equal to paymentSchedulesCount.</description>
        <name>IsPromiseToPayLimitReached</name>
        <label>Is Promise to Pay Limit Reached?</label>
        <locationX>560</locationX>
        <locationY>566</locationY>
        <defaultConnector>
            <targetReference>ScreenCollectPromiseToPayDetails</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No (Default)</defaultConnectorLabel>
        <rules>
            <name>HasReachedPromiseToPayLimit</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>MaximumPromiseToPayCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>existingPaymentSchedulesCount</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>ScreenDisplayPromisetoPayLimitReachedNotification</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <dynamicChoiceSets>
        <description>Stores the choice label and value option for PaymentSourcePicklist on the ScreenCollectPromiseToPayDetails screen.</description>
        <name>ChoicePaymentSource</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>PaymentSource</picklistField>
        <picklistObject>PaymentSchedule</picklistObject>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <formulas>
        <description>Gets the currentPaymentScheduleCount and increments the value by 1.</description>
        <name>IncrementPromiseToPayCountFormula</name>
        <dataType>Number</dataType>
        <expression>{!existingPaymentSchedulesCount}+1</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>IsChoiceFullPaymentSelected</name>
        <dataType>Boolean</dataType>
        <expression>IF(CONTAINS({!PaymentPreferenceRadioButtons},{!ChoiceFullPayment}), true, false)</expression>
    </formulas>
    <interviewLabel>RC - Create Promise to Pay {!$Flow.CurrentDateTime}</interviewLabel>
    <label>RC - Create Promise to Pay</label>
    <overriddenFlow>collection__CreatePromisetoPay</overriddenFlow>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <description>Creates a payment schedule record in a Draft state using the values that the flow user provided in the ScreenCollectPromiseToPayForm screen. Stores the ID of the new payment schedule record in PaymentScheduleId from CreatePaymentSchedule.</description>
        <name>CreatePaymentSchedule</name>
        <label>Create Payment Schedule</label>
        <locationX>1070</locationX>
        <locationY>782</locationY>
        <connector>
            <targetReference>IsCustomerOptingToPayInOneOrMorePartialPayments</targetReference>
        </connector>
        <inputAssignments>
            <field>Comments</field>
            <value>
                <elementReference>CommentsLongTextArea</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>PaymentSource</field>
            <value>
                <elementReference>PaymentSourcePicklist</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ReferenceEntityId</field>
            <value>
                <elementReference>GetCollectionPlan.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>TotalRequestedAmount</field>
            <value>
                <elementReference>PromisedAmount</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <stringValue>PromiseToPay</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UsageType</field>
            <value>
                <stringValue>CollectionPlan</stringValue>
            </value>
        </inputAssignments>
        <object>PaymentSchedule</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <description>Creates payment schedule item records using the values in the NewPaymentScheduleItems record collection.</description>
        <name>CreatePaymentScheduleItems</name>
        <label>Create Payment Schedule Items</label>
        <locationX>600</locationX>
        <locationY>1706</locationY>
        <connector>
            <targetReference>UpdateCollectionPlan</targetReference>
        </connector>
        <inputReference>NewPaymentScheduleItems</inputReference>
    </recordCreates>
    <recordLookups>
        <description>Gets the collection plan record with an ID that matches the Collection Plan ID of the record that was passed into the flow. Stores the result in the Collection Plan from GetCollectionPlan record variable.</description>
        <name>GetCollectionPlan</name>
        <label>Get Collection Plan</label>
        <locationX>560</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SetTotalOverdueAmount</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>CollectionPlan</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Gets the payment schedule records with a Reference Entity ID that matches the Collection Plan ID of the record in Collection Plan from GetCollectionPlan. Stores the result in the Payment Schedules from GetPaymentSchedules record collection.</description>
        <name>GetPaymentSchedules</name>
        <label>Get Payment Schedules</label>
        <locationX>560</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SetPaymentSchedulesCount</targetReference>
        </connector>
        <filterLogic>1 AND ( 2 OR 3 )</filterLogic>
        <filters>
            <field>ReferenceEntityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>GetCollectionPlan.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Type</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>PromiseToPay</stringValue>
            </value>
        </filters>
        <filters>
            <field>Type</field>
            <operator>EqualTo</operator>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>PaymentSchedule</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <description>Updates the collection plan record with an ID that matches the Collection Plan ID of the record in Collection Plan from GetCollectionPlan. Sets the PromiseToPayCount to IncrementPromiseToPayCount.</description>
        <name>UpdateCollectionPlan</name>
        <label>Update Collection Plan</label>
        <locationX>600</locationX>
        <locationY>1814</locationY>
        <connector>
            <targetReference>HaveEmailId</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>PromiseToPayCount</field>
            <value>
                <elementReference>IncrementPromiseToPayCountFormula</elementReference>
            </value>
        </inputAssignments>
        <object>CollectionPlan</object>
    </recordUpdates>
    <screens>
        <description>Allows the flow user to gather the payment plan details from the customer, update the Promise to Pay form, and create corresponding payment schedules.</description>
        <name>ScreenCollectPromiseToPayDetails</name>
        <label>Collect Promise to Pay Details</label>
        <locationX>1070</locationX>
        <locationY>674</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>CreatePaymentSchedule</targetReference>
        </connector>
        <fields>
            <name>ScreenCollectPromiseToPayDetails_Section1</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section1_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>PromiseToPayCountDisplayText</name>
                    <fieldText>&lt;p&gt;Promise to Pay limit:&lt;/p&gt;&lt;p&gt;{!MaximumPromiseToPayCount}&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section1_Column2</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>ExistingPromiseToPayCountDisplayText</name>
                    <fieldText>&lt;p&gt;Existing Promise to Pay count:&lt;/p&gt;&lt;p&gt;{!existingPaymentSchedulesCount}&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section1_Column3</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>TotalOverdueAmountDisplayText</name>
                    <fieldText>&lt;p&gt;Total Overdue Amount:&lt;/p&gt;&lt;p&gt;{!totalOverdueAmount}&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <fields>
            <name>ScreenCollectPromiseToPayDetails_Section2</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section2_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>PaymentPreferenceRadioButtons</name>
                    <choiceReferences>ChoiceFullPayment</choiceReferences>
                    <choiceReferences>ChoicePartialPayment</choiceReferences>
                    <dataType>String</dataType>
                    <defaultSelectedChoiceReference>ChoiceFullPayment</defaultSelectedChoiceReference>
                    <fieldText>Is the borrower agreeing to pay the entire overdue amount?</fieldText>
                    <fieldType>RadioButtons</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>false</isRequired>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section2_Column2</name>
                <fieldType>Region</fieldType>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <fields>
            <name>ScreenCollectPromiseToPayDetails_Section3</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section3_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>PromisedAmount</name>
                    <dataType>Currency</dataType>
                    <defaultValue>
                        <elementReference>totalOverdueAmount</elementReference>
                    </defaultValue>
                    <fieldText>Promised Amount</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isDisabled>
                        <elementReference>IsChoiceFullPaymentSelected</elementReference>
                    </isDisabled>
                    <isRequired>true</isRequired>
                    <scale>2</scale>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                    <validationRule>
                        <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(222, 12, 12);&quot;&gt;The sum of all the partial payment amounts must match the promised amount.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                        <formulaExpression>{!PromisedAmount} &gt; 0 &amp;&amp; ({!FirstPartialPaymentAmount}+IF({!SecondPartialPaymentAmount}&gt;0,{!SecondPartialPaymentAmount}, 0)+IF({!ThirdPartialPaymentAmount}&gt;0,{!ThirdPartialPaymentAmount}, 0)) == {!PromisedAmount}</formulaExpression>
                    </validationRule>
                </fields>
                <fields>
                    <name>TotalPaymentAmountDisplayText</name>
                    <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Total Overdue Amount {!totalOverdueAmount}&lt;/span&gt;&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                    <visibilityRule>
                        <conditionLogic>and</conditionLogic>
                        <conditions>
                            <leftValueReference>PaymentPreferenceRadioButtons</leftValueReference>
                            <operator>EqualTo</operator>
                            <rightValue>
                                <elementReference>ChoiceFullPayment</elementReference>
                            </rightValue>
                        </conditions>
                    </visibilityRule>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section3_Column2</name>
                <fieldType>Region</fieldType>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <fields>
            <name>PaymentScheduleSectionHeaderDisplayText</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;color: rgb(79, 76, 76);&quot;&gt;Payment Schedule&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <fields>
            <name>ScreenCollectPromiseToPayDetails_Section4</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section4_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>TotalPartialPaymentsPicklist</name>
                    <choiceReferences>ChoiceOnePartialPayment</choiceReferences>
                    <choiceReferences>ChoiceTwoPartialPayments</choiceReferences>
                    <choiceReferences>ChoiceThreePartialPayments</choiceReferences>
                    <dataType>Number</dataType>
                    <defaultSelectedChoiceReference>ChoiceOnePartialPayment</defaultSelectedChoiceReference>
                    <fieldText>Number of Partial Payments</fieldText>
                    <fieldType>DropdownBox</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <scale>0</scale>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section4_Column2</name>
                <fieldType>Region</fieldType>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <fields>
            <name>ScreenCollectPromiseToPayDetails_Section5</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section5_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>FirstPartialPaymentAmount</name>
                    <dataType>Currency</dataType>
                    <fieldText>First Part Payment Amount</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <scale>0</scale>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section5_Column2</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>FirstPartialPaymentDate</name>
                    <dataType>Date</dataType>
                    <fieldText>Date</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                    <validationRule>
                        <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(222, 12, 12);&quot;&gt;Enter a date that&apos;s on or after the current date.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                        <formulaExpression>{!FirstPartialPaymentDate} &gt;= TODAY()</formulaExpression>
                    </validationRule>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section5_Column3</name>
                <fieldType>Region</fieldType>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceOnePartialPayment</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>ScreenCollectPromiseToPayDetails_Section6</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section6_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>SecondPartialPaymentAmount</name>
                    <dataType>Currency</dataType>
                    <fieldText>Second Part Payment Amount</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <scale>0</scale>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section6_Column2</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>SecondPartialPaymentDate</name>
                    <dataType>Date</dataType>
                    <fieldText>Date</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                    <validationRule>
                        <errorMessage>&lt;p&gt;&lt;span style=&quot;color: rgb(222, 12, 12); background-color: rgb(255, 255, 255);&quot;&gt;Enter a date that&apos;s on or after the current date.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                        <formulaExpression>{!SecondPartialPaymentDate} &gt;= TODAY()</formulaExpression>
                    </validationRule>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section6_Column3</name>
                <fieldType>Region</fieldType>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceTwoPartialPayments</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>ScreenCollectPromiseToPayDetails_Section7</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section7_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>ThirdPartialPaymentAmount</name>
                    <dataType>Currency</dataType>
                    <fieldText>Third Part Payment Amount</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <scale>0</scale>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section7_Column2</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>ThirdPartialPaymentDate</name>
                    <dataType>Date</dataType>
                    <fieldText>Date</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                    <validationRule>
                        <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(222, 12, 12);&quot;&gt;Enter a date that&apos;s on or after the current date.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                        <formulaExpression>{!ThirdPartialPaymentDate} &gt;= TODAY()</formulaExpression>
                    </validationRule>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section7_Column3</name>
                <fieldType>Region</fieldType>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>4</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceThreePartialPayments</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>AdditionalDetailsSectionHeaderDisplayText</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;color: rgb(79, 76, 76);&quot;&gt;Additional Details&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <fields>
            <name>ScreenCollectPromiseToPayDetails_Section8</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section8_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>PaymentSourcePicklist</name>
                    <choiceReferences>ChoicePaymentSource</choiceReferences>
                    <dataType>String</dataType>
                    <fieldText>Payment Source</fieldText>
                    <fieldType>DropdownBox</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>false</isRequired>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section8_Column2</name>
                <fieldType>Region</fieldType>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <fields>
            <name>ScreenCollectPromiseToPayDetails_Section9</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section9_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>CommentsLongTextArea</name>
                    <fieldText>Comments</fieldText>
                    <fieldType>LargeTextArea</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>false</isRequired>
                    <styleProperties>
                        <verticalAlignment>
                            <stringValue>top</stringValue>
                        </verticalAlignment>
                        <width>
                            <stringValue>12</stringValue>
                        </width>
                    </styleProperties>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>ScreenCollectPromiseToPayDetails_Section9_Column2</name>
                <fieldType>Region</fieldType>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>Shows a summary of promise to pay details to the flow user after the promise to pay request is created.</description>
        <name>ScreenDisplayPromiseToPayDetails</name>
        <label>Display Promise to Pay Details</label>
        <locationX>600</locationX>
        <locationY>2798</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>PromiseToPayRequestCreatedDisplayText</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;font-size: 16px;&quot;&gt;&lt;img src=&quot;/projRes/ui-industries-collection-components/Check_small.png&quot;&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;font-size: 16px;&quot;&gt;&lt;span class=&quot;ql-cursor&quot;&gt;&lt;/span&gt;A promise to pay was created with the relevant payment schedules.&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <fields>
            <name>PaymentSchedule1DisplayText</name>
            <fieldText>&lt;p&gt;&lt;strong&gt;First Partial Payment&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceOnePartialPayment</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>PaymentSchedule1AmountDisplayText</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Amount: {!FirstPartialPaymentAmount}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceOnePartialPayment</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>PaymentSchedule1DateDisplayText</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Date: {!FirstPartialPaymentDate}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceOnePartialPayment</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>PaymentSchedule2DisplayText</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);&quot;&gt;Second Partial Payment&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceTwoPartialPayments</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>PaymentSchedule2AmountDisplayText</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Amount: {!SecondPartialPaymentAmount}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceTwoPartialPayments</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>PaymentSchedule2DateDisplayText</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Date: {!SecondPartialPaymentDate}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceTwoPartialPayments</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>PaymentSchedule3DisplayText</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);&quot;&gt;Third Partial Payment&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceThreePartialPayments</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>PaymentSchedule3AmountDisplayText</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Amount: {!ThirdPartialPaymentAmount}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceThreePartialPayments</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>PaymentSchedule3DateDisplayText</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Date: {!ThirdPartialPaymentDate}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>TotalPartialPaymentsPicklist</leftValueReference>
                    <operator>GreaterThanOrEqualTo</operator>
                    <rightValue>
                        <elementReference>ChoiceThreePartialPayments</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>EmailNotification</name>
            <fieldText>&lt;p&gt;An email with the promise to pay details is sent to &lt;span style=&quot;color: rgb(32, 19, 202);&quot;&gt;{!GetCollectionPlan.Contact.Email}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>GetCollectionPlan.Contact.Email</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>false</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>Displays a message notifying the flow user that the customer&apos;s promise to pay limit is exhausted.</description>
        <name>ScreenDisplayPromisetoPayLimitReachedNotification</name>
        <label>Display Promise to Pay Limit Reached Notification</label>
        <locationX>50</locationX>
        <locationY>674</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>PromiseToPayLimitReachedDisplayText</name>
            <fieldText>&lt;p&gt;You&apos;ve reached the promise to pay limit and you can&apos;t add any more promises to pay.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>434</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>GetCollectionPlan</targetReference>
        </connector>
    </start>
    <status>InvalidDraft</status>
    <textTemplates>
        <description>Stores the body of the email notifying the borrower about the promise to pay commitment details.</description>
        <name>Email2BodyTextTemplate</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Dear {!GetCollectionPlan.Contact.FirstName} {!GetCollectionPlan.Contact.LastName},

Here&apos;s a confirmation for your commitment to make a payment of {!PromisedAmount} for the outstanding balance in 2 installments:
{!FirstPartialPaymentAmount} by {!FirstPartialPaymentDate}
{!SecondPartialPaymentAmount} by {!SecondPartialPaymentDate}

Payment Source: {!PaymentSourcePicklist}

We appreciate your commitment to fulfil this obligation. Please ensure that you make these payments by the specified dates to uphold your commitment. For any clarifications or assistance, please contact us.

Best regards,
{!$User.Username}</text>
    </textTemplates>
    <textTemplates>
        <description>Stores the body of the email notifying the borrower about the promise to pay commitment details.</description>
        <name>Email3BodyTextTemplate</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Dear {!GetCollectionPlan.Contact.FirstName} {!GetCollectionPlan.Contact.LastName},

Here&apos;s a confirmation for your commitment to make a payment of {!PromisedAmount} for the outstanding balance in 3 installments:
{!FirstPartialPaymentAmount} by {!FirstPartialPaymentDate}
{!SecondPartialPaymentAmount} by {!SecondPartialPaymentDate}
{!ThirdPartialPaymentAmount} by {!ThirdPartialPaymentDate}

Payment Source: {!PaymentSourcePicklist}

We appreciate your commitment to fulfil this obligation. Please ensure that you make these payments by the specified dates to uphold your commitment. For any clarifications or assistance, please contact us.

Best regards,
{!$User.Username}</text>
    </textTemplates>
    <textTemplates>
        <description>Stores the body of the email notifying the borrower about the promise to pay commitment details.</description>
        <name>EmailBodyTextTemplate</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Dear {!GetCollectionPlan.Contact.FirstName} {!GetCollectionPlan.Contact.LastName},

Here&apos;s a confirmation for your commitment to make the full payment of {!PromisedAmount} for the outstanding balance by {!FirstPartialPaymentDate}.

Payment Source: {!PaymentSourcePicklist}

We appreciate your commitment to fulfil this obligation. Please ensure that you make the payments by the specified date to uphold your commitment. For any clarifications or assistance, please contact us.

Best regards,
{!$User.Username}</text>
    </textTemplates>
    <textTemplates>
        <description>Stores the subject of the email notifying the borrower about the promise to pay commitment details.</description>
        <name>EmailSubjectTextTemplate</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Confirmation of your Promise to Pay commitment</text>
    </textTemplates>
    <variables>
        <description>Stores the number of existing payment schedules for a collection plan.</description>
        <name>existingPaymentSchedulesCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <description>Stores the maximum number of promises to pay allowed for a collection plan.</description>
        <name>MaximumPromiseToPayCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>3.0</numberValue>
        </value>
    </variables>
    <variables>
        <description>Stores the payment schedule item records to be created.</description>
        <name>NewPaymentScheduleItems</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>PaymentScheduleItem</objectType>
    </variables>
    <variables>
        <description>Stores an individual payment schedule item record to be created.</description>
        <name>PaymentScheduleItem</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>PaymentScheduleItem</objectType>
    </variables>
    <variables>
        <description>Stores the ID of the collection plan record that was passed into the flow.</description>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Stores the total overdue amount for a customer.</description>
        <name>totalOverdueAmount</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
</Flow>
